<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Mastering Terraform Validation Pipelines" /><meta property="og:locale" content="en" /><meta name="description" content="In this blog post, I want to show you how to create an Azure pipeline that can be used to automatically validate your Terraform code and make suggestions for security, quality and best practices so that you can improve your scrappy code. How? using static code analysis tools! There are a lot out there for Terraform and the major private cloud providers, but I have picked just a few that have made the best impression. For a great comparison of these tools, check out this post." /><meta property="og:description" content="In this blog post, I want to show you how to create an Azure pipeline that can be used to automatically validate your Terraform code and make suggestions for security, quality and best practices so that you can improve your scrappy code. How? using static code analysis tools! There are a lot out there for Terraform and the major private cloud providers, but I have picked just a few that have made the best impression. For a great comparison of these tools, check out this post." /><link rel="canonical" href="https://blog.wenger.dev/posts/Terraform-Validation-Pipeline/" /><meta property="og:url" content="https://blog.wenger.dev/posts/Terraform-Validation-Pipeline/" /><meta property="og:site_name" content="Alex’s Blog" /><meta property="og:image" content="https://blog.wenger.dev/assets/img/terraform/preview_validation_pipeline.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-04-27T21:00:00+02:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://blog.wenger.dev/assets/img/terraform/preview_validation_pipeline.jpg" /><meta property="twitter:title" content="Mastering Terraform Validation Pipelines" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-04-27T21:00:00+02:00","datePublished":"2024-04-27T21:00:00+02:00","description":"In this blog post, I want to show you how to create an Azure pipeline that can be used to automatically validate your Terraform code and make suggestions for security, quality and best practices so that you can improve your scrappy code. How? using static code analysis tools! There are a lot out there for Terraform and the major private cloud providers, but I have picked just a few that have made the best impression. For a great comparison of these tools, check out this post.","headline":"Mastering Terraform Validation Pipelines","image":"https://blog.wenger.dev/assets/img/terraform/preview_validation_pipeline.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.wenger.dev/posts/Terraform-Validation-Pipeline/"},"url":"https://blog.wenger.dev/posts/Terraform-Validation-Pipeline/"}</script><title>Mastering Terraform Validation Pipelines | Alex's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Alex's Blog"><meta name="application-name" content="Alex's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="preconnect" href="https://cdnjs.cloudflare.com" ><link rel="dns-prefetch" href="https://cdnjs.cloudflare.com" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/avatar.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">Alex's Blog</a></h1><p class="site-subtitle fst-italic mb-0">A Collection of my boring Notes</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/GreedTP" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/alexander-wenger-2851a922b" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Mastering Terraform Validation Pipelines</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Mastering Terraform Validation Pipelines</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1714244400" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 27, 2024 </time> </span><div class="mt-3 mb-3"> <a href="/assets/img/terraform/preview_validation_pipeline.jpg" class="popup img-link preview-img shimmer"><img src="/assets/img/terraform/preview_validation_pipeline.jpg" alt="Preview Image" width="1200" height="630" loading="lazy"></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/GreedTP">Alexander Wenger</a> </em> </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="878 words" > <em>4 min</em> read</span></div></div></header><div class="content"><p>In this blog post, I want to show you how to create an Azure pipeline that can be used to automatically validate your Terraform code and make suggestions for security, quality and best practices so that you can improve your scrappy code. How? using static code analysis tools! There are a lot out there for Terraform and the major private cloud providers, but I have picked just a few that have made the best impression. For a great comparison of these tools, check out this <a href="https://devdosvid.blog/2024/04/16/a-deep-dive-into-terraform-static-code-analysis-tools-features-and-comparisons/">post</a>.</p><p>I will use the following tools:</p><ul><li>Trivy<li>TFLint<li>Semgrep OSS<li>Checkov</ul><h2 id="pipeline"><span class="me-2">Pipeline</span><a href="#pipeline" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now for the pipeline. First, we need a parameter to pass the working directory where the Terraform root file is located. The default value <code class="language-plaintext highlighter-rouge">$(Build.Repository.LocalPath)</code> represents the local path on the agent where your source files will be downloaded. We also define a stage for validation:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="na">parameters</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">workingDirectory</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
  <span class="na">default</span><span class="pi">:</span> <span class="s">$(Build.Repository.LocalPath)</span>

<span class="na">stages</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">stage</span><span class="pi">:</span> <span class="s">TerraformValidationStage</span>
  <span class="na">displayName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Terraform</span><span class="nv"> </span><span class="s">Validation'</span>
</pre></table></code></div></div><p>Next you can add each tool as a seperate step. Note that the execution differs from tool to tool. For Trivy there is a predefined task available in the marketplace. For the others we use bash scripts to install and run the tool.</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="na">parameters</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">workingDirectory</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
  <span class="na">default</span><span class="pi">:</span> <span class="s">$(Build.Repository.LocalPath)</span>

<span class="na">jobs</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">job</span><span class="pi">:</span> <span class="s">TerraformValidation</span>
  <span class="na">displayName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Terraform</span><span class="nv"> </span><span class="s">Validate'</span>
  <span class="na">steps</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">checkout</span><span class="pi">:</span> <span class="s">self</span> 
  
  <span class="pi">-</span> <span class="na">task</span><span class="pi">:</span> <span class="s">trivy@1</span>
    <span class="na">displayName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Trivy'</span>
    <span class="na">inputs</span><span class="pi">:</span>
    <span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">0.50.1'</span>
    <span class="na">path</span><span class="pi">:</span> <span class="s">$</span>
    <span class="na">exitCode</span><span class="pi">:</span> <span class="s1">'</span><span class="s">0'</span>
  
  <span class="pi">-</span> <span class="na">script</span><span class="pi">:</span> <span class="pi">|</span>
      <span class="s">curl -s https://raw.githubusercontent.com/terraform-linters/tflint/master/install_linux.sh | bash</span>

      <span class="s">tflint --version</span>
      <span class="s">tflint --init</span>
      <span class="s">tflint --minimum-failure-severity=error</span>
    <span class="na">workingDirectory</span><span class="pi">:</span> <span class="s">$</span>
    <span class="na">displayName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">TFLint'</span>
  
  <span class="pi">-</span> <span class="na">script</span><span class="pi">:</span> <span class="pi">|</span>
      <span class="s">python -m pip install --upgrade pip</span>
      <span class="s">pip install semgrep</span>

      <span class="s">semgrep --version</span>
      <span class="s">semgrep scan --config auto</span>
    <span class="na">workingDirectory</span><span class="pi">:</span> <span class="s">$</span>
    <span class="na">displayName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Semgrep</span><span class="nv"> </span><span class="s">OSS'</span>
  
  <span class="pi">-</span> <span class="na">script</span><span class="pi">:</span> <span class="pi">|</span>
      <span class="s">apt install python3-pip</span>
      <span class="s">pip3 install checkov</span>

      <span class="s">checkov --version</span>
      <span class="s">checkov -d . --hard-fail-on CRITICAL</span>
    <span class="na">workingDirectory</span><span class="pi">:</span> <span class="s">$</span>
    <span class="na">displayName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Checkov'</span>
</pre></table></code></div></div><p>For TFLint you need to add a file called <code class="language-plaintext filepath highlighter-rouge">.tflint.hcl</code> in the root of your directory which contains the providers you want to validate. In my case I use <code class="language-plaintext highlighter-rouge">azurerm</code>.</p><div file=".tflint.hcl" class="language-hcl highlighter-rouge"><div class="code-header"> <span data-label-text=".tflint.hcl"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nx">plugin</span> <span class="s2">"azurerm"</span> <span class="p">{</span>
  <span class="nx">enabled</span> <span class="p">=</span> <span class="kc">true</span>
  <span class="nx">version</span> <span class="p">=</span> <span class="s2">"0.26.0"</span>
  <span class="nx">source</span>  <span class="p">=</span> <span class="s2">"github.com/terraform-linters/tflint-ruleset-azurerm"</span>
<span class="p">}</span>
</pre></table></code></div></div><blockquote class="prompt-info"><p>To make sure that the pipeline fails only on critical findings or errors, I ran TFLint with <code class="language-plaintext highlighter-rouge">--minimum-failure-severity=error</code> and Checkov with <code class="language-plaintext highlighter-rouge">--hard-fail-on CRITICAL</code>.</p></blockquote><p>And there you go, you have built yourself a pipeline with the major Terraform static code analyzers. If you need all of them, I can’t answer that, but maybe I can make the decision easier with the following sample run to compare the tools.</p><h2 id="example-run"><span class="me-2">Example Run</span><a href="#example-run" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Following I will show you the pipeline in action with a simple terraform setup with a few obvious mistakes to check what each tool has to say.</p><div file="main.tf" class="language-hcl highlighter-rouge"><div class="code-header"> <span data-label-text="main.tf"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="nx">locals</span> <span class="p">{</span>
  <span class="nx">var_with_no_use</span> <span class="p">=</span> <span class="s2">"This is a variable with no use"</span>
<span class="p">}</span>

<span class="nx">resource</span> <span class="s2">"azurerm_resource_group"</span> <span class="s2">"example"</span> <span class="p">{</span>
  <span class="nx">name</span>     <span class="p">=</span> <span class="s2">"example-resources"</span>
  <span class="nx">location</span> <span class="p">=</span> <span class="s2">"switzerlandnorth"</span>
<span class="p">}</span>

<span class="nx">resource</span> <span class="s2">"azurerm_storage_account"</span> <span class="s2">"example"</span> <span class="p">{</span>
  <span class="nx">name</span>                      <span class="p">=</span> <span class="s2">"storageaccountname"</span>
  <span class="nx">resource_group_name</span>       <span class="p">=</span> <span class="nx">azurerm_resource_group</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">name</span>
  <span class="nx">location</span>                  <span class="p">=</span> <span class="nx">azurerm_resource_group</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">location</span>
  <span class="nx">account_tier</span>              <span class="p">=</span> <span class="s2">"Standard"</span>
  <span class="nx">account_replication_type</span>  <span class="p">=</span> <span class="s2">"LRS"</span>
  <span class="nx">min_tls_version</span>           <span class="p">=</span> <span class="s2">"TLS1_0"</span> <span class="c1"># Outdated tls version</span>
  <span class="nx">enable_https_traffic_only</span> <span class="p">=</span> <span class="kc">false</span> <span class="c1"># http enabled</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="trivy"><span class="me-2">Trivy</span><a href="#trivy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Trivy, which doesn’t output to the console but to its own “trivy” tab next to the pipeline run summary, warned me about the deprecated tls version and suggested that I enable <code class="language-plaintext highlighter-rouge">Secure transfer required</code>, which is recommended by Microsoft:</p><p><a href="/assets/img/terraform/trivy.png" class="popup img-link shimmer"><img src="/assets/img/terraform/trivy.png" alt="Trivy Example Validation" loading="lazy"></a> <em>Trivy Example Validation</em></p><h3 id="tflint"><span class="me-2">TFLint</span><a href="#tflint" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>TFLint just informed me about the unused variable:</p><p><a href="/assets/img/terraform/tflint.png" class="popup img-link shimmer"><img src="/assets/img/terraform/tflint.png" alt="TFLint Example Validation" loading="lazy"></a> <em>TFLint Example Validation</em></p><h3 id="semgrep-oss"><span class="me-2">Semgrep OSS</span><a href="#semgrep-oss" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>With semgrep we have received again a different suggestion. Firstly, the outdated TLS version again, then that http traffic should be deactivated and also that the storage analytics logs should be used:</p><p><a href="/assets/img/terraform/semgrep.png" class="popup img-link shimmer"><img src="/assets/img/terraform/semgrep.png" alt="Semgrep OSS Example Validation" loading="lazy"></a> <em>Semgrep OSS Example Validation</em></p><h3 id="checkov"><span class="me-2">Checkov</span><a href="#checkov" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We come to the last and most detailed tool, checkov. With 12 failed checks, I can’t even show them in one picture, so below is a list of the things found.</p><p><a href="/assets/img/terraform/checkov.png" class="popup img-link shimmer"><img src="/assets/img/terraform/checkov.png" alt="Checkov Example Validation" loading="lazy"></a> <em>Checkov Example Validation</em></p><ul><li>Ensure that Storage accounts disallow public access<li>Ensure Storage Account is using the latest version of TLS encryption<li>Ensure that Storage blobs restrict public access<li>Ensure that ‘enable_https_traffic_only’ is enabled<li>Ensure that Storage Accounts use replication<li>Ensure Storage logging is enabled for Queue service for read, write and delete requests<li>Ensure storage account is configured with SAS expiration policy<li>Ensure storage account is configured with private endpoint<li>Ensure soft-delete is enabled on Azure storage account<li>Ensure storage account is configured without blob anonymous access<li>Ensure storage account is not configured with Shared Key authorization<li>Ensure storage for critical data are encrypted with Customer Managed Key</ul><h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>As you can see, all the tools vary HEAVILY on the suggestions; some are very general and focus more on syntax and unused declarations, and others more on security aspects and best practices of the resources themselves. You have to decide which one to use based on your needs. You may want to use all of them together, as each tool will have its own suggestions that another tool may not have mentioned, even if things are brought up repeatedly.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/terraform/">Terraform</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/automation/" class="post-tag no-text-decoration" >automation</a> <a href="/tags/terraform/" class="post-tag no-text-decoration" >terraform</a> <a href="/tags/azure-pipelines/" class="post-tag no-text-decoration" >azure pipelines</a> <a href="/tags/iac/" class="post-tag no-text-decoration" >iac</a> <a href="/tags/devops/" class="post-tag no-text-decoration" >devops</a> <a href="/tags/static-code-analysis/" class="post-tag no-text-decoration" >static code analysis</a> <a href="/tags/trivy/" class="post-tag no-text-decoration" >trivy</a> <a href="/tags/tflint/" class="post-tag no-text-decoration" >tflint</a> <a href="/tags/semgrep-oss/" class="post-tag no-text-decoration" >semgrep oss</a> <a href="/tags/checkov/" class="post-tag no-text-decoration" >checkov</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Mastering%20Terraform%20Validation%20Pipelines%20-%20Alex's%20Blog&url=https%3A%2F%2Fblog.wenger.dev%2Fposts%2FTerraform-Validation-Pipeline%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fblog.wenger.dev%2Fposts%2FTerraform-Validation-Pipeline%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/Terraform-Validation-Pipeline/">Mastering Terraform Validation Pipelines</a><li class="text-truncate lh-lg"> <a href="/posts/Terraform-Yaml-Guide/">YAML Magic: Automating Terraform Like a Pro</a><li class="text-truncate lh-lg"> <a href="/posts/Selfhost-Guide/">Secure Self-Hosting: A Guide to Automatically Pulling and Hosting Your Static Website from GitHub</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/devops/">devops</a> <a class="post-tag btn btn-outline-primary" href="/tags/iac/">iac</a> <a class="post-tag btn btn-outline-primary" href="/tags/terraform/">terraform</a> <a class="post-tag btn btn-outline-primary" href="/tags/azure-pipelines/">azure pipelines</a> <a class="post-tag btn btn-outline-primary" href="/tags/caddy/">caddy</a> <a class="post-tag btn btn-outline-primary" href="/tags/checkov/">checkov</a> <a class="post-tag btn btn-outline-primary" href="/tags/cloudflare/">cloudflare</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/github/">github</a></div></section></div><section id="toc-wrapper" class="ps-0 pe-4"><h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/Terraform-Yaml-Guide/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1712689200" data-df="ll" > Apr 9, 2024 </time><h4 class="pt-0 my-2">YAML Magic: Automating Terraform Like a Pro</h4><div class="text-muted"><p> Following scenario: You have created an extremely well-designed Terraform that automates your boring and repetitive task, BUT you are the only one who knows how to take advantage of it. Lets take ...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/Terraform-Yaml-Guide/" class="btn btn-outline-primary" aria-label="Older" ><p>YAML Magic: Automating Terraform Like a Pro</p></a><div class="btn btn-outline-primary disabled" aria-label="Newer"><p>-</p></div></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2024</time> <a href="https://github.com/GreedTP">Alexander Wenger</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/devops/">devops</a> <a class="post-tag btn btn-outline-primary" href="/tags/iac/">iac</a> <a class="post-tag btn btn-outline-primary" href="/tags/terraform/">terraform</a> <a class="post-tag btn btn-outline-primary" href="/tags/azure-pipelines/">azure pipelines</a> <a class="post-tag btn btn-outline-primary" href="/tags/caddy/">caddy</a> <a class="post-tag btn btn-outline-primary" href="/tags/checkov/">checkov</a> <a class="post-tag btn btn-outline-primary" href="/tags/cloudflare/">cloudflare</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/github/">github</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/assets/js/dist/app.min.js"></script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
